(function(e){function t(t){for(var n,o,i=t[0],d=t[1],c=t[2],l=0,m=[];l<i.length;l++)o=i[l],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n]);u&&u(t);while(m.length)m.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,i=1;i<a.length;i++){var d=a[i];0!==s[d]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},s={app:0},r=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],d=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=d;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0087":function(e,t,a){"use strict";a("b93f")},"034f":function(e,t,a){"use strict";a("85ec")},"095c":function(e,t,a){"use strict";a("696f")},"0c89":function(e,t,a){e.exports=a.p+"img/marker-icon-red.d2b3e000.png"},1163:function(e,t,a){"use strict";a("204b")},"11d9":function(e,t,a){"use strict";a("8b3c")},"12bb":function(e,t,a){"use strict";a("505a")},1368:function(e,t,a){},"160f":function(e,t,a){},"19cd":function(e,t,a){},"204b":function(e,t,a){},2736:function(e,t,a){},"276c":function(e,t,a){"use strict";a("5532")},"2e7a":function(e,t,a){},"30ed":function(e,t,a){"use strict";a("5797")},"47a6":function(e,t,a){"use strict";a("2e7a")},"505a":function(e,t,a){},"50ef":function(e,t,a){},"515b":function(e,t,a){e.exports=a.p+"img/plan1.637d2f4c.jpg"},5532:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("main-layout")],1)},r=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-container"},[a("app-header"),e.isOneColumnMode?e._e():a("div",{staticClass:"below-header"},[a("section",{staticClass:"left-pane"},["view"===e.mode?[a("layer-list",{attrs:{layers:e.layerNames},model:{value:e.activeLayerName,callback:function(t){e.activeLayerName=t},expression:"activeLayerName"}}),a("node-list",{attrs:{nodes:e.activeLayerNodes}})]:e._e(),"newLayer"===e.mode||"editLayer"===e.mode?[a("layer-edit")]:e._e(),"newNode"===e.mode||"editNode"===e.mode?[a("node-edit")]:e._e(),"selectNode"===e.mode?[a("node-select")]:e._e(),"newReadingConfig"===e.mode||"editReadingConfig"===e.mode?[a("parameter-edit")]:e._e(),"manageUsers"===e.mode?a("user-management"):e._e(),"showUser"===e.mode?a("user-details"):e._e(),"newUser"===e.mode||"editUser"===e.mode?a("user-edit"):e._e()],2),a("main",{staticClass:"main"},["map"===e.mainDisplayMode?a("map-display",{attrs:{layer:e.activeLayer}}):e._e(),"messages"===e.mainDisplayMode?a("message-display",{attrs:{node:e.$store.state.displayedMessagesNode}}):e._e()],1)]),e.isOneColumnMode?a("div",{staticClass:"below-header-one-column"},["login"===e.mode?a("login-form"):e._e(),"changePassword"===e.mode?a("password-change-form"):e._e()],1):e._e()],1)},i=[],d=a("1da1"),c=(a("96cf"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("h2",{staticClass:"layer-list-header"},[e._v("Mapy")]),a("ul",{staticClass:"layer-list"},e._l(e.layers,(function(t){return a("li",{key:t,class:{"layer-list-item-selected":t===e.selectedLayer},on:{click:function(a){return e.layerClick(t)}}},[e._v(" "+e._s(t)+" ")])})),0)])}),u=[],l={name:"LayerList",props:{layers:Array,value:{type:String,default:""}},data:function(){return{selectedLayer:this.value}},methods:{layerClick:function(e){this.selectedLayer=e,this.$emit("input",this.selectedLayer)}}},m=l,p=(a("c0cf"),a("2877")),f=Object(p["a"])(m,c,u,!1,null,"6e48f47a",null),g=f.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.layer?a("section",[a("h2",{staticClass:"layer-details-header"},[e._v("Informacje o warstwie")]),a("dl",{staticClass:"dl-inline details-list"},[a("dt",[e._v("Nazwa")]),a("dd",[e._v(e._s(e.layer.name))]),a("dt",[e._v("Szerokość")]),a("dd",[e._v(e._s(e.layer.width)+" m")]),a("dt",[e._v("Wysokość")]),a("dd",[e._v(e._s(e.layer.height))])])]):e._e()},h=[],y={name:"LayerDetails",props:{layer:Object}},w=y,b=(a("11d9"),Object(p["a"])(w,v,h,!1,null,"1df57512",null)),C=b.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("h2",{staticClass:"node-list-header"},[e._v("Węzły")]),a("ul",{staticClass:"node-list"},e._l(e.nodes,(function(t){return a("node-item",{key:t.id,attrs:{node:t},nativeOn:{click:function(a){return e.showMessages(t)}}})})),1)])},_=[],k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"node-item",class:{"node-item-good":e.isGood,"node-item-bad":e.isBad}},[a("h3",{staticClass:"node-item-header"},[e._v(e._s(e.node.name))]),a("div",[e._v(" "+e._s(e.node.address64)+" ")]),a("div",{class:{"status-text-recognized":e.isGood,"status-text-unrecognized":e.isBad}},[e._v(" "+e._s(e.status)+" ")])])},M=[],N={name:"NodeItem",props:{node:Object},data:function(){return{}},computed:{status:function(){return this.node.discovered?"Rozpoznane":"Nierozpoznane"},isGood:function(){return this.node.discovered},isBad:function(){return!this.node.discovered}},methods:{}},R=N,P=(a("095c"),Object(p["a"])(R,k,M,!1,null,"56b60f84",null)),D=P.exports,j={name:"NodeList",components:{NodeItem:D},props:{nodes:Array},methods:{showMessages:function(e){console.log("node clicked"),this.$store.commit("setDisplayedMessagesNode",e),this.$store.commit("setMainDisplayMode","messages")}}},$=j,L=(a("1163"),Object(p["a"])($,x,_,!1,null,"a07c81a8",null)),I=L.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map-container",class:{"edited-node-mode":!!e.editedNode}},[e.mapVisible?a("l-map",{ref:"map",staticStyle:{height:"100%","z-index":"10"},attrs:{"min-zoom":e.minZoom,crs:e.crs},on:{click:e.mapClick}},[a("l-image-overlay",{attrs:{url:e.layer.imgurl,bounds:e.layerBounds}}),e._l(e.nodesToDisplay,(function(t){return a("l-marker",{key:t.name,attrs:{"lat-lng":{lng:t.x,lat:t.y},icon:e.getIcon(t)}},[a("l-tooltip",{attrs:{options:{direction:"top",permanent:!0,offset:[0,-23]}}},[a("b",[e._v(e._s(t.name))]),a("br"),e._l(t.readingConfigs,(function(t){return a("div",{key:t.name},[e._v(" "+e._s(t.name)+": "+e._s(null===t.lastReading?"---":t.lastReading)+" ")])}))],2),a("l-popup",{attrs:{content:t.name}})],1)})),e.editedNodeWasPlaced?a("l-marker",{attrs:{"lat-lng":{lng:e.editedNode.x,lat:e.editedNode.y},icon:e.editedNodeIcon}},[a("l-popup",{attrs:{content:e.editedNode.name}})],1):e._e()],2):e._e(),e.editedNode?a("div",{staticClass:"place-node-message"},[e._v(" Kliknij na mapie, aby umieścić węzeł. ")]):e._e()],1)},U=[],O=(a("4de4"),a("d81d"),a("e11e")),T=a("2699"),z=a("e464"),S=a("4e2b"),A=a("f60f"),F=a("635f"),B=a("31dc");a("6cc5");delete O["Icon"].Default.prototype._getIconUrl,O["Icon"].Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var H=[25,41],W=[12,41],q={red:Object(O["icon"])({iconUrl:a("0c89"),iconSize:H,iconAnchor:W}),green:Object(O["icon"])({iconUrl:a("a988"),iconSize:H,iconAnchor:W}),purple:Object(O["icon"])({iconUrl:a("8ec0"),iconSize:H,iconAnchor:W}),gray:Object(O["icon"])({iconUrl:a("6b39"),iconSize:H,iconAnchor:W})},Z={components:{LMap:T["a"],LImageOverlay:z["a"],LMarker:S["a"],LPopup:A["a"],LPolyline:F["a"],LTooltip:B["a"]},props:{layer:Object},data:function(){return{minZoom:-10,crs:O["CRS"].Simple,stars:[{name:"Sol",lng:1,lat:1},{name:"Mizar",lng:2,lat:1},{name:"Krueger-Z",lng:7,lat:1},{name:"Deneb",lng:5,lat:9}],travel:[[1,1],[9,5]]}},computed:{mode:function(){return this.$store.getters.mode},layerBounds:function(){return[[0,0],[this.layer.height,this.layer.width]]},layerUrl:function(){return this.layer?this.layer.imgurl:null},mapVisible:function(){return this.layer&&this.layer.imgurl},nodesToDisplay:function(){var e=this;return this.editedNode?this.layer.nodes.filter((function(t){return!e.isNodeEdited(t)})):this.layer.nodes},editedNode:function(){return this.$store.state.editedNode},editedNodeWasPlaced:function(){return this.editedNode&&"number"===typeof this.editedNode.x&&"number"===typeof this.editedNode.y},editedNodeIcon:function(){return q.purple}},methods:{isNodeEdited:function(e){return!!this.editedNode&&(null!==this.editedNode.id&&e.id===this.editedNode.id||null!==this.editedNode.tempId&&e.tempId===this.editedNode.tempId)},getIcon:function(e){return"view"===this.mode?!0===e.discovered?q.green:!1===e.discovered?q.red:q.gray:this.isNodeEdited(e)?q.purple:q.gray},mapClick:function(e){if(this.editedNode){var t={x:e.latlng.lng,y:e.latlng.lat};this.$store.commit("setCoordinatesOfEditedNode",t)}},fitBounds:function(){this.$nextTick((function(){this.layerUrl&&this.$refs.map&&this.$refs.map.mapObject.fitBounds(this.layerBounds,{animate:!1})}))}},watch:{layerUrl:function(e,t){this.fitBounds()}},mounted:function(){this.fitBounds()}},K=Z,V=(a("adcf"),Object(p["a"])(K,E,U,!1,null,"31f9f26f",null)),G=V.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"layer-edit-container",on:{submit:function(t){return t.preventDefault(),e.saveLayer.apply(null,arguments)}}},[a("div",{staticClass:"layer-edit-main"},[a("h2",{staticClass:"side-panel-h2"},[e._v(e._s(e.headerText))]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"layerNameInput"}},[e._v("Nazwa mapy")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.layerName,expression:"layerName"}],staticClass:"text-input",attrs:{type:"text",id:"layerNameInput",placeholder:"Parter"},domProps:{value:e.layerName},on:{input:function(t){t.target.composing||(e.layerName=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"floorNoInput"}},[e._v("Poziom")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.floorNo,expression:"floorNo"}],staticClass:"text-input",attrs:{type:"text",id:"floorNoInput",placeholder:"0"},domProps:{value:e.floorNo},on:{input:function(t){t.target.composing||(e.floorNo=t.target.value)}}})]),a("div",[a("h3",{staticClass:"side-panel-h3"},[e._v("Plan")]),a("label",{staticClass:"file-input-button",attrs:{for:"floorPlanInput"}},[e._v(e._s(e.imageInputText))]),a("input",{ref:"floorPlanFile",staticClass:"file-input-hidden",attrs:{type:"file",accept:"image/*",id:"floorPlanInput"},on:{change:e.loadFloorPlan}})]),e.isMapVisible?a("div",[a("h3",{staticClass:"side-panel-h3"},[e._v("Węzły sieci")]),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.addNode}},[e._v("Dodaj węzeł")]),a("ul",{staticClass:"node-list-edit"},e._l(e.layer.nodes,(function(t){return a("node-item-edit-mode",{key:e.makeNodeKey(t),attrs:{node:t},on:{"edit-node":function(a){return e.editNode(t)},"delete-node":function(a){return e.deleteNode(t)}}})})),1)]):e._e()]),a("div",{staticClass:"layer-edit-footer"},[a("button",{staticClass:"button footer-button",attrs:{type:"button"},on:{click:e.discardLayer}},[e._v("Anuluj")]),a("button",{staticClass:"button footer-button",attrs:{type:"submit"}},[e._v("Zapisz")])])])},Q=[],X=(a("b0c0"),a("d3b7"),a("25f0"),a("3ca3"),a("ddb0"),a("2b3d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"node-item",on:{click:e.editClick}},[n("div",{staticClass:"node-item-content"},[n("h3",{staticClass:"node-item-header"},[e._v(e._s(e.node.name))]),n("div",[e._v(" "+e._s(e.node.address64)+" ")])]),n("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.deleteClick.apply(null,arguments)}}},[n("img",{attrs:{src:a("7387"),width:"35",height:"35"}})])])}),Y=[],ee={name:"NodeItemEditMode",props:{node:Object},data:function(){return{}},computed:{},methods:{editClick:function(){this.$emit("edit-node")},deleteClick:function(){this.$emit("delete-node")}}},te=ee,ae=(a("fd41"),Object(p["a"])(te,X,Y,!1,null,"6ae206c4",null)),ne=ae.exports,se={name:"LayerEdit",components:{NodeItemEditMode:ne},props:{},data:function(){return{keepRatio:!0,image:null}},computed:{newLayerMode:function(){return"newLayer"===this.$store.getters.mode},editLayerMode:function(){return"editLayer"===this.$store.getters.mode},headerText:function(){return this.newLayerMode?"Nowa mapa":"Edytuj mapę"},imageInputText:function(){return this.newLayerMode?"Dodaj plik z planem":"Załaduj nowy plan"},layer:function(){return this.$store.state.editedLayer},isMapVisible:function(){return this.layer&&this.layer.imgurl},layerName:{get:function(){return this.layer.name},set:function(e){this.$store.commit("setEditedLayerParam",{name:"name",value:e})}},floorNo:{get:function(){return this.layer.number},set:function(e){this.$store.commit("setEditedLayerParam",{name:"number",value:e})}}},methods:{makeNodeKey:function(e){var t="number"===typeof e.id?e.id.toString():"",a="number"===typeof e.tempId?e.tempId.toString():"";return t+"_"+a},addNode:function(){this.$store.commit("prepareNewNode"),this.$store.commit("pushMode","newNode")},editNode:function(e){this.$store.commit("prepareNodeForEdit",e),this.$store.commit("pushMode","editNode")},deleteNode:function(e){this.$store.commit("deleteNode",e)},loadFloorPlan:function(e){var t=e.target.files[0];if(t){URL.createObjectURL(t);this.$store.dispatch("loadLayerImage",t)}this.$store.commit("setEditedLayerParam",{name:"isNewImage",value:!0})},saveLayer:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("saveEditedLayer");case 3:e.$store.commit("setActiveLayer",e.layer.name),e.$store.commit("previousMode"),e.$store.commit("setEditedLayer",null),e.$store.dispatch("downloadDiscoveryResults"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},discardLayer:function(){this.$store.commit("previousMode"),this.$store.commit("setEditedLayer",null)}},mounted:function(){this.isNewImage=!1}},re=se,oe=(a("30ed"),Object(p["a"])(re,J,Q,!1,null,"0aff61dd",null)),ie=oe.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"node-edit-container",on:{submit:function(t){return t.preventDefault(),e.saveNode.apply(null,arguments)}}},[a("div",{staticClass:"node-edit-main"},[a("h2",{staticClass:"side-panel-h2"},[e._v(e._s(e.headerText))]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"nodeNameInput"}},[e._v("Nazwa węzła")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.nodeName,expression:"nodeName"}],staticClass:"text-input",attrs:{type:"text",id:"nodeNameInput",placeholder:"np. czujnik dymu"},domProps:{value:e.nodeName},on:{input:function(t){t.target.composing||(e.nodeName=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"nodeAddressInput"}},[e._v("64-bitowy adres węzła")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.nodeAddress,expression:"nodeAddress"}],staticClass:"text-input",attrs:{type:"text",id:"nodeAddressInput",placeholder:"np. 0123456789ABCDEF"},domProps:{value:e.nodeAddress},on:{input:function(t){t.target.composing||(e.nodeAddress=t.target.value)}}}),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.searchDevice}},[e._v("Szukaj urządzenia")])]),e._m(0),a("div",[a("h3",{staticClass:"side-panel-h3"},[e._v("Wyświetlane wartości")]),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.addReadingConfig}},[e._v("Dodaj wartość")]),a("ul",{staticClass:"parameter-list-edit"},e._l(e.node.readingConfigs,(function(t){return a("node-parameter",{key:e.makeParameterKey(t),attrs:{readingConfig:t},on:{"edit-config":function(a){return e.editConfig(t)},"delete-config":function(a){return e.deleteConfig(t)}}})})),1)])]),a("div",{staticClass:"node-edit-footer"},[a("button",{staticClass:"button footer-button",attrs:{type:"button"},on:{click:e.discardNode}},[e._v("Anuluj")]),a("button",{staticClass:"button footer-button",attrs:{type:"submit"}},[e._v(e._s(e.submitButtonText))])])])},ce=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h3",{staticClass:"side-panel-h3"},[e._v("Pozycja węzła na planie")]),e._v(" Kliknij na planie aby wskazać pozycję węzła. ")])}],ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"node-item",on:{click:e.editClick}},[n("div",{staticClass:"node-item-content"},[n("h3",{staticClass:"node-item-header"},[e._v(e._s(e.readingConfig.name))])]),n("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.deleteClick.apply(null,arguments)}}},[n("img",{attrs:{src:a("7387"),width:"35",height:"35"}})])])},le=[],me={name:"NodeParameter",props:{readingConfig:Object},data:function(){return{}},methods:{editClick:function(){this.$emit("edit-config")},deleteClick:function(){this.$emit("delete-config")}}},pe=me,fe=(a("5924"),Object(p["a"])(pe,ue,le,!1,null,"38dd0f01",null)),ge=fe.exports,ve={name:"NodeEdit",components:{NodeItemEditMode:ne,NodeParameter:ge},props:{},data:function(){return{}},computed:{newNodeMode:function(){return"newNode"===this.$store.getters.mode},headerText:function(){return this.newNodeMode?"Dodawanie węzła":"Edycja węzła"},submitButtonText:function(){return this.newNodeMode?"Dodaj":"Zapisz"},node:function(){return this.$store.state.editedNode},nodeName:{get:function(){return this.node.name},set:function(e){this.$store.commit("setEditedNodeParam",{name:"name",value:e})}},nodeAddress:{get:function(){return this.node.address64},set:function(e){this.$store.commit("setEditedNodeParam",{name:"address64",value:e})}}},methods:{makeParameterKey:function(e){var t="number"===typeof e.id?e.id.toString():"",a="number"===typeof e.tempId?e.tempId.toString():"";return t+"_"+a},searchDevice:function(){this.$store.commit("pushMode","selectNode")},addReadingConfig:function(){this.$store.commit("prepareNewReadingConfig"),this.$store.commit("pushMode","newReadingConfig")},editConfig:function(e){this.$store.commit("prepareReadingConfigForEdit",e),this.$store.commit("pushMode","editReadingConfig")},deleteConfig:function(e){this.$store.commit("deleteReadingConfig",e)},saveNode:function(){this.$store.commit("saveEditedNode"),this.$store.commit("previousMode")},discardNode:function(){this.$store.commit("discardEditedNode"),this.$store.commit("previousMode","editLayer")}},mounted:function(){this.isNewImage=!1}},he=ve,ye=(a("9bbf"),Object(p["a"])(he,de,ce,!1,null,"6c1794c2",null)),we=ye.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"message-display-container"},[a("div",{staticClass:"message-display-header"},[a("label",{staticClass:"mode-radio-item"},[e._v(" Text "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.displayMode,expression:"displayMode"}],attrs:{type:"radio",value:"text",name:"radioMessageDisplayMode",id:"radioModeText"},domProps:{checked:e._q(e.displayMode,"text")},on:{change:function(t){e.displayMode="text"}}})]),a("label",{staticClass:"mode-radio-item"},[e._v(" Hex "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.displayMode,expression:"displayMode"}],attrs:{type:"radio",value:"hex",name:"radioMessageDisplayMode",id:"radioModeHex"},domProps:{checked:e._q(e.displayMode,"hex")},on:{change:function(t){e.displayMode="hex"}}})]),a("div",[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.showMap}},[e._v("Pokaż mapę")])])]),a("div",{staticClass:"message-display-messages"},e._l(e.messagesToDisplay,(function(t){return a("zigbee-message",{key:t.tempId,attrs:{message:t,mode:e.displayMode}})})),1),a("div",{staticClass:"message-display-footer"},[a("div",{staticClass:"writing-mode-container"},[a("label",{staticClass:"mode-radio-item"},[e._v(" Wyślij komunikat "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.writingMode,expression:"writingMode"}],attrs:{type:"radio",value:"message",name:"radioWritingMode"},domProps:{checked:e._q(e.writingMode,"message")},on:{change:function(t){e.writingMode="message"}}})]),a("label",{staticClass:"mode-radio-item"},[e._v(" Odczytaj parametr "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.writingMode,expression:"writingMode"}],attrs:{type:"radio",value:"getParameter",name:"radioWritingMode"},domProps:{checked:e._q(e.writingMode,"getParameter")},on:{change:function(t){e.writingMode="getParameter"}}})]),a("label",{staticClass:"mode-radio-item"},[e._v(" Zapisz parametr "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.writingMode,expression:"writingMode"}],attrs:{type:"radio",value:"setParameter",name:"radioWritingMode"},domProps:{checked:e._q(e.writingMode,"setParameter")},on:{change:function(t){e.writingMode="setParameter"}}})]),a("label",{staticClass:"mode-radio-item"},[e._v(" Wykonaj rozkaz "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.writingMode,expression:"writingMode"}],attrs:{type:"radio",value:"executeCommand",name:"radioWritingMode"},domProps:{checked:e._q(e.writingMode,"executeCommand")},on:{change:function(t){e.writingMode="executeCommand"}}})])]),"message"===e.writingMode?a("div",{staticClass:"message-display-inputs"},[a("div",{staticClass:"message-input-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.messageToSend,expression:"messageToSend"}],staticClass:"text-input message-input",attrs:{type:"text"},domProps:{value:e.messageToSend},on:{input:function(t){t.target.composing||(e.messageToSend=t.target.value)}}})]),a("div",{staticClass:"button-send-container"},[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v("Wyślij")])])]):e._e(),"getParameter"===e.writingMode||"setParameter"===e.writingMode||"executeCommand"===e.writingMode?a("div",{staticClass:"at-command-container"},[a("div",{staticClass:"at-command-item"},[a("label",{staticClass:"at-data-label",attrs:{for:"atCommandName"}},[e._v("Komenda AT")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandName,expression:"atCommandName"}],staticClass:"text-input at-command-input",attrs:{type:"text",id:"atCommandName"},domProps:{value:e.atCommandName},on:{input:function(t){t.target.composing||(e.atCommandName=t.target.value)}}})]),a("div",{staticClass:"at-command-item"},[a("div",[e._v(" Typ danych ")]),a("div",{staticClass:"at-data-mode-container"},[a("label",{staticClass:"mode-radio-item"},[e._v(" Brak "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atDataMode,expression:"atDataMode"}],attrs:{type:"radio",value:"none",name:"atDataMode"},domProps:{checked:e._q(e.atDataMode,"none")},on:{change:function(t){e.atDataMode="none"}}})]),a("label",{staticClass:"mode-radio-item"},[e._v(" Text "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atDataMode,expression:"atDataMode"}],attrs:{type:"radio",value:"text",name:"atDataMode"},domProps:{checked:e._q(e.atDataMode,"text")},on:{change:function(t){e.atDataMode="text"}}})]),a("label",{staticClass:"mode-radio-item"},[e._v(" Hex "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atDataMode,expression:"atDataMode"}],attrs:{type:"radio",value:"hex",name:"atDataMode"},domProps:{checked:e._q(e.atDataMode,"hex")},on:{change:function(t){e.atDataMode="hex"}}})])])]),a("div",{staticClass:"at-command-item"},[a("label",{staticClass:"at-data-label",attrs:{for:"atCommandData"}},[e._v("Dane")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandData,expression:"atCommandData"}],staticClass:"text-input at-data-input",attrs:{type:"text",disabled:"none"===e.atDataMode,id:"atCommandData"},domProps:{value:e.atCommandData},on:{input:function(t){t.target.composing||(e.atCommandData=t.target.value)}}})]),a("div",{staticClass:"at-command-item"},[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.sendAtCommand}},[e._v("Wyślij")])])]):e._e()])])},Ce=[],xe=(a("ac1f"),a("1276"),a("a15b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("article",{staticClass:"zigbee-message",class:e.boundClasses},[e.showNodeInfo?a("div",{staticClass:"zigbee-message-header"},[a("b",[e._v(e._s(e.message.nodeName))]),e._v(" "+e._s(e.message.address64)+" ")]):e._e(),"sent"===e.message.type||"received"===e.message.type?a("div",{staticClass:"zigbee-message-content"},["text"===e.mode?[e._v(" "+e._s(e.messageAsText)+" ")]:e._e(),"hex"===e.mode?[e._v(" "+e._s(e.messageAsHex)+" ")]:e._e()],2):e._e(),"at"===e.message.type?a("div",{staticClass:"zigbee-message-content"},[a("b",[e._v("Komenda AT")]),e._v(": "+e._s(e.message.atCommand)),a("br"),null!==e.message.value?[a("b",[e._v("Dane:")]),e._v(" "+e._s(e.atCommandData)),a("br")]:e._e(),null!==e.message.result?[a("b",[e._v("Wynik:")]),e._v(" "+e._s(e.atCommandResult)+" ")]:e._e()],2):e._e()])}),_e=[],ke=a("2909"),Me=(a("99af"),a("4d90"),{name:"ZigbeeMessage",props:{message:Object,mode:{type:String,default:"text",validator:function(e){return-1!==["text","hex"].indexOf(e)}},showNodeInfo:{type:Boolean,default:!1}},data:function(){return{}},computed:{boundClasses:function(){return{"zigbee-message-left":"received"===this.message.type,"zigbee-message-right":"sent"===this.message.type||"at"===this.message.type}},messageAsText:function(){return this.decodeTextMessage(this.message.message)},messageAsHex:function(){return this.decodeHexMessage(this.message.message)},atCommandData:function(){return"text"===this.message.format?this.decodeTextMessage(this.message.value):"hex"===this.message.format?this.decodeHexMessage(this.message.value):""},atCommandResult:function(){if(!this.message.result)return"";var e=this.decodeHexMessage(this.message.result),t=this.decodeTextMessage(this.message.result);return"".concat(e," (").concat(t,")")}},methods:{decodeTextMessage:function(e){return atob(e)},decodeHexMessage:function(e){var t=atob(e);return Object(ke["a"])(t).map((function(e){return e.charCodeAt(0).toString(16).padStart(2,"0")})).join(" ")}}}),Ne=Me,Re=(a("8c48"),Object(p["a"])(Ne,xe,_e,!1,null,"92fcca2e",null)),Pe=Re.exports,De={name:"MessageDisplay",components:{ZigbeeMessage:Pe},props:{node:Object},data:function(){return{writingMode:"message",atDataMode:"none",displayMode:"text",atCommandName:"",atCommandData:"",messageToSend:""}},computed:{messagesToDisplay:function(){var e=this;return this.$store.state.messages.filter((function(t){return t.address64===e.node.address64}))}},methods:{sendMessage:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.getEncodedMessage(),n={type:"sent",address64:e.node.address64,message:a},t.next=5,e.$store.dispatch("sendMessage",n);case 5:e.messageToSend="",t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getEncodedMessage:function(){return"text"===this.displayMode?this.encodeTextMessage(this.messageToSend):"hex"===this.displayMode?this.encodeHexMessage(this.messageToSend):void 0},encodeTextMessage:function(e){return btoa(e)},encodeHexMessage:function(e){var t=e.split(/\s+/).map((function(e){return parseInt(e,16)})),a=t.every((function(e){return!isNaN(e)&&e>=0&&e<=255}));if(!a)throw new Error("Invalid hex string");var n=t.map((function(e){return String.fromCharCode(e)})).join("");return btoa(n)},getEncodedCommandValue:function(){return"text"===this.atDataMode?this.encodeTextMessage(this.atCommandData):"hex"===this.atDataMode?this.encodeHexMessage(this.atCommandData):null},getAtCommandType:function(){return"getParameter"===this.writingMode?"get_parameter":"setParameter"===this.writingMode?"set_parameter":"executeCommand"===this.writingMode?"execute_command":""},sendAtCommand:function(){try{var e={commandType:this.getAtCommandType(),address64:this.node.address64,atCommand:this.atCommandName,value:this.getEncodedCommandValue(),format:this.atDataMode};this.$store.dispatch("sendAtCommand",e)}catch(t){console.error(t)}},showMap:function(){this.$store.commit("setMainDisplayMode","map")}},watch:{atDataMode:function(e){"none"===e&&(this.atCommandData="")}}},je=De,$e=(a("9a50"),Object(p["a"])(je,be,Ce,!1,null,"5b4b27ae",null)),Le=$e.exports,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",{staticClass:"header"},[n("h1",{staticClass:"page-title",attrs:{tabindex:"0"},on:{click:e.showMainMode}},[e._v("Monitor sieci ZigBee")]),n("nav",[e.isViewMode?[n("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:e.refresh}},[e._v("Odśwież")]),n("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:e.editNewLayer}},[e._v("Dodaj mapę")]),n("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:e.editActiveLayer}},[e._v("Edytuj mapę")]),n("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:e.deleteActiveLayer}},[e._v("Usuń mapę")]),e.isAdmin?n("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:e.manageUsers}},[e._v("Użytkownicy")]):e._e()]:e._e(),e.isUsersManagement?n("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:e.showMainMode}},[e._v("Mapa")]):e._e(),e.isLoggedIn?[n("dropdown-menu",{scopedSlots:e._u([{key:"toggle-button",fn:function(){return[n("img",{staticClass:"user-icon",attrs:{src:a("d104")}}),n("span",{staticClass:"button-username"},[e._v(e._s(e.user?e.user.username:""))])]},proxy:!0},{key:"content",fn:function(){return[n("button",{staticClass:"dropdown-list-button",attrs:{type:"button"},on:{click:e.changePassword}},[e._v("Zmień hasło")]),n("button",{staticClass:"dropdown-list-button",attrs:{type:"button"},on:{click:e.logout}},[e._v("Wyloguj")])]},proxy:!0}],null,!1,859535529)})]:e._e()],2)])},Ee=[],Ue=(a("caad"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dropdown-menu"},[a("button",{staticClass:"header-button dropdown-toggle button-username",attrs:{type:"button"},on:{click:e.toggleDropdown}},[e._t("toggle-button")],2),e.expanded?a("div",{staticClass:"dropdown-content",on:{click:e.collapseDropdown}},[e._t("content")],2):e._e()])}),Oe=[],Te={name:"AppHeader",data:function(){return{expanded:!1}},methods:{toggleDropdown:function(){this.expanded=!this.expanded},collapseDropdown:function(){this.expanded=!1}}},ze=Te,Se=Object(p["a"])(ze,Ue,Oe,!1,null,"e17c1faa",null),Ae=Se.exports,Fe={name:"AppHeader",components:{DropdownMenu:Ae},data:function(){return{}},computed:{isViewMode:function(){return"view"===this.$store.getters.mode},isUsersManagement:function(){var e=["changePassword","manageUsers","showUser","newUser","editUser"];return e.includes(this.$store.getters.mode)},isLoggedIn:function(){return null!==this.$store.state.user},isAdmin:function(){return this.user&&"admin"===this.user.role},user:function(){return this.$store.state.user}},methods:{showMainMode:function(){this.$store.commit("pushMode","view")},editNewLayer:function(){this.$store.commit("prepareNewLayer"),this.$store.commit("pushMode","newLayer")},editActiveLayer:function(){this.$store.commit("prepareLayerForEdit",this.$store.getters.activeLayer),this.$store.commit("pushMode","editLayer")},deleteActiveLayer:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("deleteLayer",e.$store.getters.activeLayer);case 2:case"end":return t.stop()}}),t)})))()},refresh:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,e.target.disabled=!0,a.next=4,t.$store.dispatch("downloadDiscoveryResults");case 4:return a.prev=4,e.target.disabled=!1,a.finish(4);case 7:case"end":return a.stop()}}),a,null,[[0,,4,7]])})))()},logout:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("logout");case 3:e.$store.commit("replaceMode","login"),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},changePassword:function(){this.$store.commit("pushMode","changePassword")},manageUsers:function(){this.$store.commit("pushMode","manageUsers")}}},Be=Fe,He=(a("5994"),Object(p["a"])(Be,Ie,Ee,!1,null,"5490d87f",null)),We=He.exports,qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"login-form-container",on:{submit:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[a("h2",{staticClass:"side-panel-h2 login-header"},[e._v("Logowanie")]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"usernameInput"}},[e._v("Użytkownik")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"text-input",attrs:{type:"text",id:"usernameInput"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"passwordInput"}},[e._v("Hasło")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"text-input",attrs:{type:"password",id:"passwordInput"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e.isError?a("div",{staticClass:"error-message"},[e._v(" "+e._s(e.errorMsg)+" ")]):e._e(),e._m(0)])},Ze=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"buttons-right"},[a("button",{staticClass:"button",attrs:{type:"submit"}},[e._v("Zaloguj")])])}],Ke={name:"LoginForm",components:{},props:{},data:function(){return{username:"",password:"",isError:!1,errorMsg:""}},methods:{login:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={username:e.username,password:e.password},t.prev=1,t.next=4,e.$store.dispatch("login",a);case 4:return t.next=6,e.$store.dispatch("loadDataAfterLogin");case 6:t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0),e.showError("Nieprawidłowa nazwa użytkownika lub hasło.");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},showError:function(e){this.errorMsg=e,this.isError=!0}}},Ve=Ke,Ge=(a("276c"),Object(p["a"])(Ve,qe,Ze,!1,null,"f8252e68",null)),Je=Ge.exports,Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"password-form-container",on:{submit:function(t){return t.preventDefault(),e.changePassword.apply(null,arguments)}}},[a("h2",{staticClass:"side-panel-h2 login-header"},[e._v("Zmiana hasła")]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"oldPasswordInput"}},[e._v("Stare hasło")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.oldPassword,expression:"oldPassword"}],staticClass:"text-input",attrs:{type:"password",id:"oldPasswordInput"},domProps:{value:e.oldPassword},on:{input:function(t){t.target.composing||(e.oldPassword=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"newPasswordInput"}},[e._v("Nowe hasło")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newPassword,expression:"newPassword"}],staticClass:"text-input",attrs:{type:"password",id:"newPasswordInput"},domProps:{value:e.newPassword},on:{input:function(t){t.target.composing||(e.newPassword=t.target.value)}}})]),e.isError?a("div",{staticClass:"error-message"},[e._v(" "+e._s(e.errorMsg)+" ")]):e._e(),a("div",{staticClass:"buttons-right"},[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.backToPreviousMode}},[e._v("Anuluj")]),a("button",{staticClass:"button",attrs:{type:"submit"}},[e._v("Zmień hasło")])]),e.passwordChangeSuccessful?a("div",[e._v(" Hasło zostało zmienione. ")]):e._e()])},Xe=[],Ye={name:"PasswordChangeForm",data:function(){return{oldPassword:"",newPassword:"",isError:!1,errorMsg:"",passwordChangeSuccessful:!1}},methods:{changePassword:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={oldPassword:e.oldPassword,newPassword:e.newPassword},t.prev=1,t.next=4,e.$store.dispatch("changePassword",a);case 4:e.passwordChangeSuccessful=!0,setTimeout(e.logout,2e3),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0),e.showError("Wystąpił błąd podczas zmiany hasła.");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},showError:function(e){this.errorMsg=e,this.isError=!0},backToPreviousMode:function(){this.$store.commit("previousMode")},logout:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("logout");case 2:e.$store.commit("replaceMode","login");case 3:case"end":return t.stop()}}),t)})))()}}},et=Ye,tt=(a("668f"),Object(p["a"])(et,Qe,Xe,!1,null,"3f2e18a8",null)),at=tt.exports,nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"node-select-container"},[a("h2",[e._v("Wybierz węzeł")]),a("section",[a("h3",[e._v("Nowe węzły")]),e._l(e.nodesNotInSystem,(function(t){return a("node-item-select-mode",{key:t.address64,attrs:{node:t},on:{"select-node":function(a){return e.selectNode(t)}}})}))],2),a("section",[a("h3",[e._v("Węzły obecne w systemie")]),e._l(e.nodesInSystem,(function(t){return a("node-item-select-mode",{key:t.address64,attrs:{node:t},on:{"select-node":function(a){return e.selectNode(t)}}})}))],2)])},st=[],rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("article",{staticClass:"node-item-select",on:{click:e.nodeSelectClick}},[a("div",[a("b",[e._v("Id urządzenia: ")]),e._v(e._s(e.node.deviceId)+" ")]),a("div",[a("b",[e._v("Adres 16-bit: ")]),e._v(" "+e._s(e.node.address16)+" ")]),a("div",[a("b",[e._v("Adres 64-bit: ")]),e._v(" "+e._s(e.node.address64)+" ")]),a("div",[a("b",[e._v("Typ węzła: ")]),e._v(e._s(e.node.role)+" ")])])},ot=[],it={name:"NodeItemSelectMode",props:{node:Object},data:function(){return{}},computed:{},methods:{nodeSelectClick:function(){this.$emit("select-node")}}},dt=it,ct=(a("9878"),Object(p["a"])(dt,rt,ot,!1,null,"1a59625d",null)),ut=ct.exports,lt={name:"NodeSelect",components:{NodeItemSelectMode:ut},props:{},data:function(){return{}},computed:{nodesNotInSystem:function(){return this.$store.getters.discoveredNodesNotInSystem},nodesInSystem:function(){return this.$store.getters.discoveredNodesInSystem}},methods:{selectNode:function(e){this.$store.commit("setEditedNodeParam",{name:"address64",value:e.address64}),this.$store.commit("previousMode")}}},mt=lt,pt=Object(p["a"])(mt,nt,st,!1,null,"34172c1a",null),ft=pt.exports,gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"parameter-edit-container",on:{submit:function(t){return t.preventDefault(),e.saveParameter.apply(null,arguments)}}},[a("div",{staticClass:"parameter-edit-main"},[a("h2",{staticClass:"side-panel-h2"},[e._v(e._s(e.headerText))]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"parameterNameInput"}},[e._v("Nazwa parametru")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.parameterName,expression:"parameterName"}],staticClass:"text-input",attrs:{type:"text",id:"parameterNameInput"},domProps:{value:e.parameterName},on:{input:function(t){t.target.composing||(e.parameterName=t.target.value)}}})]),a("div",{staticClass:"radio-set-container"},[a("div",{staticClass:"radio-set-legend"},[e._v("Sposób odczytu parametru")]),a("div",{staticClass:"radio-set-content"},[a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.readMode,expression:"readMode"}],staticClass:"radio-input",attrs:{type:"radio",value:"listen",name:"parameterReadMode",id:"parameterReadModeListen","aria-describedby":"modeListenDescription"},domProps:{checked:e._q(e.readMode,"listen")},on:{change:function(t){e.readMode="listen"}}}),a("label",{attrs:{for:"parameterReadModeListen"}},[e._v("Oczekuj na komunikat")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.readMode,expression:"readMode"}],staticClass:"radio-input",attrs:{type:"radio",value:"send",name:"parameterReadMode",id:"parameterReadModeSend","aria-describedby":"modeSendDescription"},domProps:{checked:e._q(e.readMode,"send")},on:{change:function(t){e.readMode="send"}}}),a("label",{attrs:{for:"parameterReadModeSend"}},[e._v("Wyślij komunikat i oczekuj na odpowiedź")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.readMode,expression:"readMode"}],staticClass:"radio-input",attrs:{type:"radio",value:"at",name:"parameterReadMode",id:"parameterReadModeAt","aria-describedby":"modeAtDescription"},domProps:{checked:e._q(e.readMode,"at")},on:{change:function(t){e.readMode="at"}}}),a("label",{attrs:{for:"parameterReadModeAt"}},[e._v("Odczytaj parametr AT")])])])]),a("div",{staticClass:"option-description"},["listen"===e.readMode?a("span",{attrs:{id:"modeListenDescription"}},[e._v(" Aplikacja będzie oczekiwać na komunikaty przysłane z urządzenia o zadanym formacie. ")]):e._e(),"send"===e.readMode?a("span",{attrs:{id:"modeSendDescription"}},[e._v(" Aplikacja będzie wysyłać co określony czas komunikat od urządzenia a następnie oczekiwał na odpowiedź o zadanym formacie. ")]):e._e(),"at"===e.readMode?a("span",{attrs:{id:"modeAtDescription"}},[e._v(" Aplikacja będzie wysyłać komentę AT do urządzenia i wyświetlać jej wynik. ")]):e._e()]),"listen"===e.readMode?a("div",[a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"messagePrefixInput"}},[e._v("Początek oczekiwanego komunikatu")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.messagePrefix,expression:"messagePrefix"}],staticClass:"text-input",attrs:{type:"text",id:"messagePrefixInput"},domProps:{value:e.messagePrefix},on:{input:function(t){t.target.composing||(e.messagePrefix=t.target.value)}}})])]):e._e(),"send"===e.readMode?a("div",[a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"messageToSendInput"}},[e._v("Komunikat do wysłania w celu odczytu wiadomości")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.messageToSend,expression:"messageToSend"}],staticClass:"text-input",attrs:{type:"text",id:"messageToSendInput"},domProps:{value:e.messageToSend},on:{input:function(t){t.target.composing||(e.messageToSend=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"messageRefreshPeriodInput"}},[e._v("Czas odświeżania w sekundach")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.refreshPeriod,expression:"refreshPeriod"}],staticClass:"text-input refresh-time-input",attrs:{type:"text",id:"messageRefreshPeriodInput"},domProps:{value:e.refreshPeriod},on:{input:function(t){t.target.composing||(e.refreshPeriod=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"receivedMessagePrefixInput"}},[e._v("Początek oczekiwanego komunikatu")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.messagePrefix,expression:"messagePrefix"}],staticClass:"text-input",attrs:{type:"text",id:"receivedMessagePrefixInput"},domProps:{value:e.messagePrefix},on:{input:function(t){t.target.composing||(e.messagePrefix=t.target.value)}}})])]):e._e(),"at"===e.readMode?a("div",[a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"at-data-label",attrs:{for:"atCommandName"}},[e._v("Nazwa komendy AT")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommand,expression:"atCommand"}],staticClass:"text-input at-command-input",attrs:{type:"text",id:"atCommandName",maxlength:"2"},domProps:{value:e.atCommand},on:{input:function(t){t.target.composing||(e.atCommand=t.target.value)}}})]),a("div",[a("div",{staticClass:"radio-set-legend"},[e._v("Format danych komendy AT")]),a("div",{staticClass:"radio-set-content"},[a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandFormat,expression:"atCommandFormat"}],staticClass:"radio-input",attrs:{type:"radio",name:"atDataMode",id:"atDataModeNone",value:"none"},domProps:{checked:e._q(e.atCommandFormat,"none")},on:{change:function(t){e.atCommandFormat="none"}}}),a("label",{attrs:{for:"atDataModeNone"}},[e._v("Brak danych")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandFormat,expression:"atCommandFormat"}],staticClass:"radio-input",attrs:{type:"radio",name:"atDataMode",id:"atDataModeText",value:"text"},domProps:{checked:e._q(e.atCommandFormat,"text")},on:{change:function(t){e.atCommandFormat="text"}}}),a("label",{attrs:{for:"atDataModeText"}},[e._v("Dane w formacie tekstowym")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandFormat,expression:"atCommandFormat"}],staticClass:"radio-input",attrs:{type:"radio",name:"atDataMode",id:"atDataModeHex",value:"hex"},domProps:{checked:e._q(e.atCommandFormat,"hex")},on:{change:function(t){e.atCommandFormat="hex"}}}),a("label",{attrs:{for:"atDataModeHex"}},[e._v("Dane w formacie heksadecymalnym")])])])]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"at-data-label",attrs:{for:"atCommandData"}},[e._v("Dane komendy AT")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandData,expression:"atCommandData"}],staticClass:"text-input",attrs:{type:"text",disabled:"none"===e.atCommandFormat,id:"atCommandData"},domProps:{value:e.atCommandData},on:{input:function(t){t.target.composing||(e.atCommandData=t.target.value)}}})]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"atRefreshPeriodInput"}},[e._v("Czas odświeżania w sekundach")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.refreshPeriod,expression:"refreshPeriod"}],staticClass:"text-input refresh-time-input",attrs:{type:"text",id:"atRefreshPeriodInput"},domProps:{value:e.refreshPeriod},on:{input:function(t){t.target.composing||(e.refreshPeriod=t.target.value)}}})]),a("div",[a("div",{staticClass:"radio-set-legend"},[e._v("Format wyniku komendy")]),a("div",{staticClass:"radio-set-content"},[a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandResultFormat,expression:"atCommandResultFormat"}],staticClass:"radio-input",attrs:{type:"radio",name:"atCommandResponseFormat",id:"atCommandResponseFormatText",value:"text"},domProps:{checked:e._q(e.atCommandResultFormat,"text")},on:{change:function(t){e.atCommandResultFormat="text"}}}),a("label",{attrs:{for:"atCommandResponseFormatText"}},[e._v("Dane tekstowe")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandResultFormat,expression:"atCommandResultFormat"}],staticClass:"radio-input",attrs:{type:"radio",name:"atCommandResponseFormat",id:"atCommandResponseFormatDec",value:"dec"},domProps:{checked:e._q(e.atCommandResultFormat,"dec")},on:{change:function(t){e.atCommandResultFormat="dec"}}}),a("label",{attrs:{for:"atCommandResponseFormatDec"}},[e._v("Liczba dziesiętna")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.atCommandResultFormat,expression:"atCommandResultFormat"}],staticClass:"radio-input",attrs:{type:"radio",name:"atCommandResponseFormat",id:"atCommandResponseFormatHex",value:"hex"},domProps:{checked:e._q(e.atCommandResultFormat,"hex")},on:{change:function(t){e.atCommandResultFormat="hex"}}}),a("label",{attrs:{for:"atCommandResponseFormatHex"}},[e._v("Dane w formacie heksadecymalnym")])])])])]):e._e()]),a("div",{staticClass:"parameter-edit-footer"},[a("button",{staticClass:"button footer-button",attrs:{type:"button"},on:{click:e.discardChanges}},[e._v("Anuluj")]),a("button",{staticClass:"button footer-button",attrs:{type:"submit"}},[e._v(e._s(e.submitButtonText))])])])},vt=[],ht={encodeTextMessage:yt,encodeHexMessage:wt,decodeMessageToText:bt,decodeMessageToHex:Ct,decodeToDecBigEndian:xt};function yt(e){return btoa(e)}function wt(e){var t=e.split(/\s+/).map((function(e){return parseInt(e,16)})),a=t.every((function(e){return!isNaN(e)&&e>=0&&e<=255}));if(!a)throw new Error("Invalid hex string");var n=t.map((function(e){return String.fromCharCode(e)})).join("");return btoa(n)}function bt(e){return atob(e)}function Ct(e){var t=atob(e);return Object(ke["a"])(t).map((function(e){return e.charCodeAt(0).toString(16).padStart(2,"0")})).join(" ")}function xt(e){var t=atob(e);return Object(ke["a"])(t).map((function(e){return e.charCodeAt(0)})).reduce((function(e,t){return t+(e<<8)}))}var _t={name:"ParameterEdit",components:{},props:{},data:function(){return{atCommandFormat:"none",rawMessagePrefix:"",rawMessageToSend:"",rawCommandData:""}},computed:{readingConfig:function(){return this.$store.state.editedReadingConfig},parameterName:{get:function(){return this.readingConfig.name},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"name",value:e})}},readMode:{get:function(){return this.readingConfig.mode},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"mode",value:e})}},messagePrefix:{get:function(){return null===this.readingConfig.messagePrefix?"":atob(this.readingConfig.messagePrefix)},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"messagePrefix",value:btoa(e)})}},messageToSend:{get:function(){return null===this.readingConfig.messageToSend?"":atob(this.readingConfig.messageToSend)},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"messageToSend",value:btoa(e)})}},refreshPeriod:{get:function(){return this.readingConfig.refreshPeriod},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"refreshPeriod",value:e})}},atCommand:{get:function(){return this.readingConfig.atCommand},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"atCommand",value:e})}},atCommandData:{get:function(){return"text"===this.atCommandFormat?ht.decodeMessageToText(this.readingConfig.atCommandData):"hex"===this.atCommandFormat?ht.decodeMessageToHex(this.readingConfig.atCommandData):null},set:function(e){var t=this.getEncodedCommandData(e);this.$store.commit("setEditedReadingConfigParam",{name:"atCommandData",value:t})}},atCommandResultFormat:{get:function(){return this.readingConfig.atCommandResultFormat},set:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"atCommandResultFormat",value:e})}},newConfigMode:function(){return"newReadingConfig"===this.$store.getters.mode},headerText:function(){return this.newConfigMode?"Nowy parametr":"Edycja parametru"},submitButtonText:function(){return this.newConfigMode?"Dodaj":"Zapisz"}},methods:{discardChanges:function(){this.$store.commit("discardEditedReadingConfig"),this.$store.commit("previousMode")},saveParameter:function(){this.$store.commit("saveEditedReadingConfig"),this.$store.commit("previousMode")},getEncodedCommandData:function(e){return"text"===this.atCommandFormat?ht.encodeTextMessage(e):"hex"===this.atCommandFormat?ht.encodeHexMessage(e):null},setAtCommandData:function(e){this.$store.commit("setEditedReadingConfigParam",{name:"atCommandData",value:e})}},watch:{},mounted:function(){null===this.readingConfig.atCommandData?this.atCommandFormat="none":this.atCommandFormat="hex"}},kt=_t,Mt=(a("0087"),Object(p["a"])(kt,gt,vt,!1,null,"3e28d690",null)),Nt=Mt.exports,Rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("h2",{staticClass:"user-list-header"},[e._v("Użytkownicy")]),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.addUser}},[e._v("Dodaj użytkownika")]),a("ul",{staticClass:"user-list"},e._l(e.users,(function(t){return a("user-item",{key:t.id,attrs:{user:t},nativeOn:{click:function(a){return e.showUser(t)}}})})),1)])},Pt=[],Dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"user-item"},[a("h3",{staticClass:"user-item-header",class:{"header-disabled":e.user.disabled}},[e._v(e._s(e.user.username))]),a("div",[e._v(" "+e._s(e.role)+" ")])])},jt=[],$t={name:"UserItem",props:{user:Object},computed:{role:function(){var e="admin"===this.user.role?"Administrator":"Użytkownik",t=this.user.disabled?" (zablokowany)":"";return e+t}},methods:{}},Lt=$t,It=(a("6951"),Object(p["a"])(Lt,Dt,jt,!1,null,"036688be",null)),Et=It.exports,Ut={name:"UserManagement",components:{UserItem:Et},props:{},computed:{users:function(){return this.$store.state.users.users}},methods:{showUser:function(e){this.$store.commit("selectUser",e),this.$store.commit("pushMode","showUser")},addUser:function(){this.$store.commit("selectNewUser"),this.$store.commit("pushMode","newUser")}},mounted:function(){this.$store.dispatch("getUsers")}},Ot=Ut,Tt=(a("12bb"),Object(p["a"])(Ot,Rt,Pt,!1,null,"ee8c565e",null)),zt=Tt.exports,St=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"heading-back-group"},[a("button",{staticClass:"heading-back-button",attrs:{type:"button"},on:{click:e.back}}),a("h2",{staticClass:"heading-back-heading"},[e._v("Użytkownik "+e._s(e.user.username))])]),a("dl",{staticClass:"dl-inline"},[a("dt",[e._v("Nazwa użytkownika: ")]),a("dd",[e._v(e._s(e.user.username))]),a("dt",[e._v("Rola: ")]),a("dd",[e._v(e._s(e.role))]),a("dt",[e._v("Zablokowany: ")]),a("dd",[e._v(e._s(e.disabledText))])]),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.deleteUser}},[e._v("Usuń użytkownika")]),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.editUser}},[e._v("Edytuj użytkownika")])])},At=[],Ft={name:"UserManagement",components:{UserItem:Et},props:{},computed:{user:function(){return this.$store.state.users.selectedUser},role:function(){return"admin"===this.user.role?"Administrator":"Użytkownik"},disabledText:function(){return this.user.disabled?"Tak":"Nie"}},methods:{back:function(){this.$store.commit("previousMode")},editUser:function(){this.$store.commit("pushMode","editUser")},deleteUser:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("deleteUser",e.user);case 2:e.$store.commit("deleteUser",e.user),e.$store.commit("previousMode");case 4:case"end":return t.stop()}}),t)})))()}}},Bt=Ft,Ht=(a("47a6"),Object(p["a"])(Bt,St,At,!1,null,"1fb7400e",null)),Wt=Ht.exports,qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"heading-back-group"},[a("button",{staticClass:"heading-back-button",attrs:{type:"button"},on:{click:e.back}}),a("h2",{staticClass:"heading-back-heading"},[e._v(e._s(e.headerText))])]),a("form",{on:{submit:function(t){return t.preventDefault(),e.saveUser.apply(null,arguments)}}},[a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"userNameInput"}},[e._v("Nazwa użytkownika")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"text-input",attrs:{type:"text",id:"userNameInput"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),e.newUserMode?e._e():a("div",{staticClass:"radio-set-container"},[a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isPasswordChanged,expression:"isPasswordChanged"}],staticClass:"checkbox-input",attrs:{type:"checkbox",id:"checkboxChangePassword"},domProps:{checked:Array.isArray(e.isPasswordChanged)?e._i(e.isPasswordChanged,null)>-1:e.isPasswordChanged},on:{change:function(t){var a=e.isPasswordChanged,n=t.target,s=!!n.checked;if(Array.isArray(a)){var r=null,o=e._i(a,r);n.checked?o<0&&(e.isPasswordChanged=a.concat([r])):o>-1&&(e.isPasswordChanged=a.slice(0,o).concat(a.slice(o+1)))}else e.isPasswordChanged=s}}}),a("label",{attrs:{for:"checkboxChangePassword"}},[e._v("Zmień hasło")])])]),a("div",{staticClass:"input-label-group"},[a("label",{staticClass:"text-label",attrs:{for:"passwordInput"}},[e._v("Hasło")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"text-input",attrs:{type:"password",id:"passwordInput",disabled:e.passwordFieldDisabled},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),a("div",{staticClass:"radio-set-container"},[a("div",{staticClass:"radio-set-legend"},[e._v("Rola")]),a("div",{staticClass:"radio-set-content"},[a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.role,expression:"role"}],staticClass:"radio-input",attrs:{type:"radio",value:"user",name:"userRole",id:"userRoleUser","aria-describedby":"roleUserDescription"},domProps:{checked:e._q(e.role,"user")},on:{change:function(t){e.role="user"}}}),a("label",{attrs:{for:"userRoleUser"}},[e._v("Użytkownik")])]),a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.role,expression:"role"}],staticClass:"radio-input",attrs:{type:"radio",value:"admin",name:"userRole",id:"userRoleAdmin","aria-describedby":"roleAdminDescription"},domProps:{checked:e._q(e.role,"admin")},on:{change:function(t){e.role="admin"}}}),a("label",{attrs:{for:"userRoleAdmin"}},[e._v("Administrator")])])])]),a("div",{staticClass:"option-description"},["user"===e.role?a("span",{attrs:{id:"roleUserDescription"}},[e._v(" Użytkownik może odczytywać stan urządzeń, dodawać, modyfikować i usuwać mapy i urządzenia, a także wysyłać i odbierać pakiety od urządzeń. ")]):e._e(),"admin"===e.role?a("span",{attrs:{id:"roleAdminDescription"}},[e._v(" Administrator ma wszystkie uprawnienia zwykłego użytwkownika i dodatkowo może zarządzać kontami użytkowników. ")]):e._e()]),a("div",{staticClass:"radio-set-container"},[a("div",{staticClass:"radio-item-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.userDisabled,expression:"userDisabled"}],staticClass:"checkbox-input",attrs:{type:"checkbox",id:"checkboxUserDisabled"},domProps:{checked:Array.isArray(e.userDisabled)?e._i(e.userDisabled,null)>-1:e.userDisabled},on:{change:function(t){var a=e.userDisabled,n=t.target,s=!!n.checked;if(Array.isArray(a)){var r=null,o=e._i(a,r);n.checked?o<0&&(e.userDisabled=a.concat([r])):o>-1&&(e.userDisabled=a.slice(0,o).concat(a.slice(o+1)))}else e.userDisabled=s}}}),a("label",{attrs:{for:"checkboxUserDisabled"}},[e._v("Zablokuj użytkownika")])])]),a("div",[a("button",{staticClass:"button",attrs:{type:"submit"}},[e._v(e._s(e.submitButtonText))])])])])},Zt=[],Kt={name:"UserEdit",data:function(){return{isPasswordChanged:!1}},components:{},props:{},computed:{user:function(){return this.$store.state.users.selectedUser},mode:function(){return this.$store.getters.mode},newUserMode:function(){return"newUser"===this.mode},headerText:function(){return this.newUserMode?"Dodawanie użytkownika":"Edycja użytkownika "+this.user.username},passwordFieldDisabled:function(){return!this.newUserMode&&!this.isPasswordChanged},submitButtonText:function(){return this.newNodeMode?"Dodaj":"Zapisz"},username:{get:function(){return this.user.username},set:function(e){this.$store.commit("setSelectedUserParam",{name:"username",value:e})}},password:{get:function(){return this.user.password},set:function(e){this.$store.commit("setSelectedUserParam",{name:"password",value:e})}},role:{get:function(){return this.user.role},set:function(e){this.$store.commit("setSelectedUserParam",{name:"role",value:e})}},userDisabled:{get:function(){return this.user.disabled},set:function(e){this.$store.commit("setSelectedUserParam",{name:"disabled",value:e})}}},methods:{back:function(){this.$store.commit("reselectUser"),this.$store.commit("previousMode")},saveUser:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.passwordFieldDisabled&&(e.password=null),!e.newUserMode){t.next=6;break}return t.next=4,e.$store.dispatch("addUser",e.user);case 4:t.next=8;break;case 6:return t.next=8,e.$store.dispatch("modifyUser",e.user);case 8:e.back();case 9:case"end":return t.stop()}}),t)})))()}},watch:{isPasswordChanged:function(e){!1===e&&(this.password=null)}}},Vt=Kt,Gt=Object(p["a"])(Vt,qt,Zt,!1,null,"42b6b896",null),Jt=Gt.exports,Qt={name:"MainLayout",components:{LayerList:g,LayerDetails:C,NodeList:I,MapDisplay:G,LayerEdit:ie,NodeEdit:we,MessageDisplay:Le,AppHeader:We,LoginForm:Je,NodeSelect:ft,ParameterEdit:Nt,PasswordChangeForm:at,UserManagement:zt,UserDetails:Wt,UserEdit:Jt},data:function(){return{nodes:[{name:"Lodówka",deviceId:"lodowka",address16:"ABCD",address64:"DEADBEEF12345678",nodeType:"router",discovered:!0},{name:"Żarówka nr 8 w żyrandolu",deviceId:"zar8",address16:"BACA",address64:"0000111122223333",nodeType:"router",discovered:!1},{name:"Czujnik dymu",deviceId:"czujnik dymu",address16:"ABCD",address64:"DEADBEEF12345678",nodeType:"end",discovered:!1},{name:"Termometr",deviceId:"termo",address16:"ABCD",address64:"DEADBEEF12345678",nodeType:"end",discovered:!0}]}},computed:{mode:function(){return this.$store.getters.mode},isOneColumnMode:function(){return this.$store.getters.isOneColumnMode},mainDisplayMode:function(){return this.$store.state.mainDisplayMode},layers:function(){return this.$store.state.layers},activeLayer:function(){return this.$store.getters.activeLayer},activeLayerNodes:function(){return null===this.activeLayer?[]:this.activeLayer.nodes},activeLayerName:{get:function(){return this.$store.state.activeLayerName},set:function(e){this.$store.commit("setActiveLayer",e)}},layerNames:function(){return this.$store.getters.layerNames}},methods:{},mounted:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("loadDataAfterLogin");case 3:t.next=7;break;case 5:t.prev=5,t.t0=t["catch"](0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})))()}},Xt=Qt,Yt=(a("ba67"),Object(p["a"])(Xt,o,i,!1,null,"44de18ef",null)),ea=Yt.exports,ta={name:"App",components:{MainLayout:ea}},aa=ta,na=(a("034f"),Object(p["a"])(aa,s,r,!1,null,null,null)),sa=na.exports,ra=a("5530"),oa=a("b85c"),ia=(a("7db0"),a("c740"),a("a434"),a("4d63"),a("466d"),a("159b"),a("2f62")),da=(a("4e82"),a("0644")),ca=a.n(da);function ua(){var e=1;function t(){return e++}return{next:t}}function la(e){var t=0,a=-1,n=1;function s(){if(a++,a===e[t].nodes.length){a=0;do{t++,t===e.length&&(t=0)}while(0===e[t].nodes.length)}var s=e[t].nodes[a].address64,r=btoa("Message number "+n++);return{type:"received",address64:s,message:r}}function r(){t=0,a=-1}return{next:s,reset:r}}var ma=ua(),pa=ua(),fa=ua(),ga=[{id:ma.next(),name:"1 Piętro",imgurl:a("515b"),number:1,width:10,height:10,nodes:[{id:pa.next(),name:"Lodówka",address64:"DEADBEEF12345678",x:1,y:1,readingConfigs:[]},{id:pa.next(),name:"Żarówka nr 8 w żyrandolu",address64:"0000111122223333",x:8,y:4,readingConfigs:[]}]},{id:ma.next(),name:"Parter",imgurl:a("ec27"),number:0,width:7.8,height:5,nodes:[{id:pa.next(),name:"Czujnik dymu",address64:"9999000099990000",x:1,y:4,readingConfigs:[]},{id:pa.next(),name:"Termometr",address64:"BACABECE87654321",x:5,y:2,readingConfigs:[{name:"Temperatura",mode:"listen",messagePrefix:btoa("temp"),messageToSend:null,refreshPeriod:null,atCommand:null,atCommandData:null},{name:"Ciśnienie",mode:"send",messagePrefix:btoa("press"),messageToSend:btoa("getpress"),refreshPeriod:10,atCommand:null,atCommandData:null},{name:"Wilgotność",mode:"at",messagePrefix:null,messageToSend:null,refreshPeriod:5,atCommand:"HU",atCommandData:null}]}]}];fa.next(),fa.next(),fa.next(),la(ga);var va=a("bc3a"),ha=a.n(va),ya={getLayers:ja,getDiscoveryResults:La,sendLayer:Ea,deleteLayer:Oa,makeMessageSocket:za,getToken:Ca,setToken:_a,getCurrentUser:ka,login:wa,logout:Na,changePassword:Pa,sendAtCommand:Sa,sendMessage:Fa,getUsers:Ha,addUser:qa,modifyUser:Ka,deleteUser:Ga};function wa(e){return ba.apply(this,arguments)}function ba(){return ba=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("username",t.username),a.append("password",t.password),e.next=5,ha.a.post(sn("/login"),a,{headers:{"Content-Type":"multipart/form-data"}});case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))),ba.apply(this,arguments)}function Ca(e){return xa.apply(this,arguments)}function xa(){return xa=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("username",t.username),a.append("password",t.password),e.next=5,ha.a.post(sn("/token"),a,{headers:{"Content-Type":"multipart/form-data"}});case 5:if(n=e.sent,s=n.data.access_token,console.log(s),"string"===typeof s){e.next=10;break}throw new Error("Invalid token.");case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)}))),xa.apply(this,arguments)}function _a(e){e,ha.a.defaults.headers.common["Authorization"]="Bearer "+e}function ka(){return Ma.apply(this,arguments)}function Ma(){return Ma=Object(d["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.get(sn("/users/me"));case 2:return t=e.sent,console.log(t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)}))),Ma.apply(this,arguments)}function Na(){return Ra.apply(this,arguments)}function Ra(){return Ra=Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.post(sn("/logout"));case 2:null,delete ha.a.defaults.headers.common["Authorization"];case 4:case"end":return e.stop()}}),e)}))),Ra.apply(this,arguments)}function Pa(e){return Da.apply(this,arguments)}function Da(){return Da=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=nn(t),console.log(a),e.next=4,ha.a.post(sn("/password-change"),a);case 4:n=e.sent,console.log(n);case 6:case"end":return e.stop()}}),e)}))),Da.apply(this,arguments)}function ja(){return $a.apply(this,arguments)}function $a(){return $a=Object(d["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.get(sn("/floors"));case 2:return t=e.sent,a=t.data,Qa(a),console.log(a),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))),$a.apply(this,arguments)}function La(){return Ia.apply(this,arguments)}function Ia(){return Ia=Object(d["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.get(sn("/network-discovery"));case 2:return t=e.sent,console.log(t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)}))),Ia.apply(this,arguments)}function Ea(e,t){return Ua.apply(this,arguments)}function Ua(){return Ua=Object(d["a"])(regeneratorRuntime.mark((function e(t,a){var n,s,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Xa(t),console.log("layer sent",n),"number"!==typeof t.id){e.next=9;break}return e.next=5,ha.a.put(sn("/floors/"+t.id),n);case 5:r=e.sent,s=r.data,e.next=13;break;case 9:return e.next=11,ha.a.post(sn("/floors"),n);case 11:o=e.sent,s=o.data;case 13:if(!a){e.next=19;break}return i=new FormData,i.append("file",a),console.log("sending image file"),e.next=19,ha.a.put(sn("/floors/"+s.id+"/image"),i,{headers:{"Content-Type":"multipart/form-data"}});case 19:return console.log("layer returned",s),e.abrupt("return",s);case 21:case"end":return e.stop()}}),e)}))),Ua.apply(this,arguments)}function Oa(e){return Ta.apply(this,arguments)}function Ta(){return Ta=Object(d["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.delete(sn("/floors/"+t.id));case 2:case"end":return e.stop()}}),e)}))),Ta.apply(this,arguments)}function za(){var e=window.location,t="https:"===e.protocol?"wss://":"ws://",a=t+e.host+"/message-socket",n=new WebSocket(a);return n.onerror=function(e){return console.log("WebSocket error",e)},n.onclose=function(e){return console.log("WebSocket closed",e)},n}function Sa(e){return Aa.apply(this,arguments)}function Aa(){return Aa=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=an(t),e.next=3,ha.a.post(sn("/xbee-at-command"),a);case 3:return n=e.sent,console.log(n),e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)}))),Aa.apply(this,arguments)}function Fa(e){return Ba.apply(this,arguments)}function Ba(){return Ba=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={address64:t.address64,message:t.message},e.next=3,ha.a.post(sn("/xbee-message"),a);case 3:return n=e.sent,console.log(n),e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)}))),Ba.apply(this,arguments)}function Ha(){return Wa.apply(this,arguments)}function Wa(){return Wa=Object(d["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.get(sn("/users"));case 2:return t=e.sent,console.log(t),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)}))),Wa.apply(this,arguments)}function qa(e){return Za.apply(this,arguments)}function Za(){return Za=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.post(sn("/users"),t);case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),Za.apply(this,arguments)}function Ka(e){return Va.apply(this,arguments)}function Va(){return Va=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.put(sn("/users/"+t.id),t);case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),Va.apply(this,arguments)}function Ga(e){return Ja.apply(this,arguments)}function Ja(){return Ja=Object(d["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ha.a.delete(sn("/users/"+t.id));case 2:case"end":return e.stop()}}),e)}))),Ja.apply(this,arguments)}function Qa(e){var t,a=Object(oa["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.imgurl=sn("/floors/"+n.id+"/image");var s,r=Object(oa["a"])(n.nodes);try{for(r.s();!(s=r.n()).done;){var o=s.value;o.address16=null,o.deviceId=null,o.role=null,o.discovered=null,o.tempId=null;var i=o.reading_configs.map(tn);o.readingConfigs=i}}catch(d){r.e(d)}finally{r.f()}}}catch(d){a.e(d)}finally{a.f()}}function Xa(e){var t=e.nodes.map(Ya),a={name:e.name,number:e.number,width:e.width,height:e.height,nodes:t};return a}function Ya(e){return{id:e.id,name:e.name,address64:e.address64,x:e.x,y:e.y,reading_configs:e.readingConfigs.map(en)}}function en(e){return{id:e.id,name:e.name,mode:e.mode,refresh_period:e.refreshPeriod,message_prefix:e.messagePrefix,message_to_send:e.messageToSend,at_command:e.atCommand,at_command_data:e.atCommandData,at_command_result_format:e.atCommandResultFormat}}function tn(e){return{id:e.id,tempId:null,name:e.name,mode:e.mode,refreshPeriod:e.refresh_period,messagePrefix:e.message_prefix,messageToSend:e.message_to_send,atCommand:e.at_command,atCommandData:e.at_command_data,atCommandResultFormat:e.at_command_result_format,lastReading:null}}function an(e){return{address64:e.address64,command_type:e.commandType,at_command:e.atCommand,value:e.value}}function nn(e){return{old_password:e.oldPassword,new_password:e.newPassword}}function sn(e){return""+e}var rn=ya;function on(){var e=1;function t(){return e++}return{next:t}}var dn=a("9062"),cn=a.n(dn),un={state:function(){return{users:[],selectedUser:null}},getters:{},mutations:{setUsers:function(e,t){e.users=t},addUser:function(e,t){e.users.push(t)},modifyUser:function(e,t){var a=e.users.findIndex((function(e){return e.id===t.id}));e.users.splice(a,1,t)},deleteUser:function(e,t){var a=e.users.findIndex((function(e){return e.id===t.id}));e.users.splice(a,1)},selectUser:function(e,t){var a=ca()(t);a.password=null,e.selectedUser=a},selectNewUser:function(e){e.selectedUser={id:null,username:null,password:null,role:"user",disabled:!1}},reselectUser:function(e){if(e.selectedUser&&null!==e.selectedUser.id){var t=e.users.find((function(t){return t.id===e.selectedUser.id}));e.selectedUser=t?ca()(t):null}else e.selectedUser=null},setSelectedUserParam:function(e,t){e.selectedUser[t.name]=t.value}},actions:{getUsers:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,rn.getUsers();case 2:a=t.sent,e.commit("setUsers",a);case 4:case"end":return t.stop()}}),t)})))()},addUser:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,rn.addUser(t);case 2:n=a.sent,e.commit("addUser",n);case 4:case"end":return a.stop()}}),a)})))()},modifyUser:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,rn.modifyUser(t);case 2:n=a.sent,e.commit("modifyUser",n);case 4:case"end":return a.stop()}}),a)})))()},deleteUser:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,rn.deleteUser(t);case 2:e.commit("deleteUser",t);case 3:case"end":return a.stop()}}),a)})))()}}};n["a"].use(ia["a"]);var ln=on(),mn=on(),pn=["view","newLayer","editLayer","newNode","editNode","selectNode","newReadingConfig","editReadingConfig","login","changePassword","manageUsers","showUser","newUser","editUser"];function fn(e){return-1!==pn.indexOf(e)}function gn(e){var t=["login","changePassword"];return-1!==t.indexOf(e)}var vn=new ia["a"].Store({state:{user:null,modeStack:["login"],mainDisplayMode:"map",layers:[],editedLayer:null,editedLayerImageFile:null,editedNode:null,editedReadingConfig:null,activeLayerName:null,discoveryResults:null,displayedMessagesNode:null,readingTimers:[],messages:[{type:"sent",address64:"DEADBEEF12345678",message:btoa("ledon"),tempId:mn.next()},{type:"received",address64:"DEADBEEF12345678",message:btoa("temp 31"),tempId:mn.next()},{type:"received",address64:"DEADBEEF12345678",message:btoa("result 234"),tempId:mn.next()},{type:"sent",address64:"DEADBEEF12345678",message:btoa("freeze"),tempId:mn.next()}],messageSocket:null},getters:{mode:function(e){return e.modeStack[e.modeStack.length-1]},isOneColumnMode:function(e,t){return gn(t.mode)},activeLayer:function(e){if(null===e.editedLayer){var t=e.layers.find((function(t){return t.name===e.activeLayerName}));return t||null}return e.editedLayer},layerNames:function(e){return e.layers.map((function(e){return e.name}))},nodeAddressesInSystem:function(e){var t,a={},n=Object(oa["a"])(e.layers);try{for(n.s();!(t=n.n()).done;){var s,r=t.value,o=Object(oa["a"])(r.nodes);try{for(o.s();!(s=o.n()).done;){var i=s.value;a[i.address64]=!0}}catch(d){o.e(d)}finally{o.f()}}}catch(d){n.e(d)}finally{n.f()}return a},discoveredNodesNotInSystem:function(e,t){if(null===e.discoveryResults)return[];var a=t.nodeAddressesInSystem;return e.discoveryResults.devices.filter((function(e){return!a[e.address64]}))},discoveredNodesInSystem:function(e,t){if(null===e.discoveryResults)return[];var a=t.nodeAddressesInSystem;return e.discoveryResults.devices.filter((function(e){return a[e.address64]}))}},mutations:{setUser:function(e,t){e.user=t},pushMode:function(e,t){if(!fn(t))throw new Error("Invalid mode");e.modeStack.push(t)},replaceMode:function(e,t){if(!fn(t))throw new Error("Invalid mode");e.modeStack.length>0&&e.modeStack.pop(),e.modeStack.push(t)},previousMode:function(e){e.modeStack.length>1&&e.modeStack.pop()},setMainDisplayMode:function(e,t){e.mainDisplayMode=t},setLayers:function(e,t){e.layers=t},setDiscoveryResults:function(e,t){e.discoveryResults=t},setActiveLayer:function(e,t){e.activeLayerName=t},setEditedLayer:function(e,t){e.editedLayer=t},setEditedLayerParam:function(e,t){e.editedLayer[t.name]=t.value},setEditedLayerImage:function(e,t){e.editedLayerImageFile=t.file,e.editedLayer.imgurl=t.imgurl,e.editedLayer.width=t.width,e.editedLayer.height=t.height},prepareNewLayer:function(e){e.editedLayer={name:null,imgurl:null,number:null,width:null,height:null,nodes:[],isNewImage:!1}},prepareLayerForEdit:function(e,t){e.editedLayer=ca()(t),e.editedLayer.isNewImage=!1},prepareNewNode:function(e){e.editedNode={id:null,tempId:null,name:null,address64:null,x:null,y:null,readingConfigs:[]}},prepareNodeForEdit:function(e,t){e.editedNode=ca()(t)},setEditedNodeParam:function(e,t){e.editedNode[t.name]=t.value},setCoordinatesOfEditedNode:function(e,t){e.editedNode.x=t.x,e.editedNode.y=t.y},saveEditedNode:function(e){if(null!==e.editedNode.id){var t=e.editedLayer.nodes.findIndex((function(t){return t.id===e.editedNode.id}));-1!==t&&e.editedLayer.nodes.splice(t,1,e.editedNode)}else if(null!==e.editedNode.tempId){var a=e.editedLayer.nodes.findIndex((function(t){return t.tempId===e.editedNode.tempId}));-1!==a&&e.editedLayer.nodes.splice(a,1,e.editedNode)}else e.editedNode.tempId=ln.next(),e.editedLayer.nodes.push(e.editedNode);e.editedNode=null},discardEditedNode:function(e){e.editedNode=null},deleteNode:function(e,t){if(null!==t.id){var a=e.editedLayer.nodes.findIndex((function(e){return e.id===t.id}));-1!==a&&e.editedLayer.nodes.splice(a,1)}else if(null!==t.tempId){var n=e.editedLayer.nodes.findIndex((function(e){return e.tempId===t.tempId}));-1!==n&&e.editedLayer.nodes.splice(n,1)}},prepareNewReadingConfig:function(e){e.editedReadingConfig={id:null,tempId:null,name:null,mode:null,messagePrefix:null,messageToSend:null,refreshPeriod:null,atCommand:null,atCommandData:null,atCommandResultFormat:null,lastReading:null}},prepareReadingConfigForEdit:function(e,t){e.editedReadingConfig=ca()(t)},setEditedReadingConfigParam:function(e,t){e.editedReadingConfig[t.name]=t.value},saveEditedReadingConfig:function(e){if(null!==e.editedReadingConfig.id){var t=e.editedNode.readingConfigs.findIndex((function(t){return t.id===e.editedReadingConfig.id}));-1!==t&&e.editedNode.readingConfigs.splice(t,1,e.editedReadingConfig)}else if(null!==e.editedReadingConfig.tempId){var a=e.editedNode.readingConfigs.findIndex((function(t){return t.tempId===e.editedReadingConfig.tempId}));-1!==a&&e.editedNode.readingConfigs.splice(a,1,e.editedReadingConfig)}else e.editedReadingConfig.tempId=ln.next(),e.editedNode.readingConfigs.push(e.editedReadingConfig);e.editedReadingConfig=null},discardEditedReadingConfig:function(e){e.editedReadingConfig=null},deleteReadingConfig:function(e,t){if(null!==t.id){var a=e.editedNode.readingConfigs.findIndex((function(e){return e.id===t.id}));-1!==a&&e.editedNode.readingConfigs.splice(a,1)}else if(null!==t.tempId){var n=e.editedNode.readingConfigs.findIndex((function(e){return e.tempId===t.tempId}));-1!==n&&e.editedNode.readingConfigs.splice(n,1)}},writeDiscoveryStatusToNodes:function(e){if(null!==e.discoveryResults){var t,a=Object(oa["a"])(e.layers);try{for(a.s();!(t=a.n()).done;){var n,s=t.value,r=Object(oa["a"])(s.nodes);try{var o=function(){var t=n.value,a=e.discoveryResults.devices.find((function(e){return e.address64===t.address64}));"undefined"===typeof a?(t.discovered=!1,t.address16=null,t.role=null,t.deviceId=null):(t.discovered=!0,t.address16=a.address16,t.role=a.role,t.deviceId=a.deviceId)};for(r.s();!(n=r.n()).done;)o()}catch(i){r.e(i)}finally{r.f()}}}catch(i){a.e(i)}finally{a.f()}}},addMessage:function(e,t){t.tempId=mn.next(),e.messages.push(t)},setDisplayedMessagesNode:function(e,t){e.displayedMessagesNode=t},updateLastReadings:function(e,t){var a,n=ht.decodeMessageToText(t.message),s=Object(oa["a"])(e.layers);try{for(s.s();!(a=s.n()).done;){var r,o=a.value,i=Object(oa["a"])(o.nodes);try{for(i.s();!(r=i.n()).done;){var d=r.value;if(d.address64===t.address64){var c,u=Object(oa["a"])(d.readingConfigs);try{for(u.s();!(c=u.n()).done;){var l=c.value;if("listen"===l.mode||"send"===l.mode){var m=ht.decodeMessageToText(l.messagePrefix),p=new RegExp("^"+cn()(m)+"\\s*(.*)"),f=n.match(p);if(null!==f){var g=f[1];l.lastReading=g}}}}catch(v){u.e(v)}finally{u.f()}}}}catch(v){i.e(v)}finally{i.f()}}}catch(v){s.e(v)}finally{s.f()}},setLastReading:function(e,t){t.readingConfig.lastReading=t.lastReading},addReadingTimer:function(e,t){e.readingTimers.push(t)},clearReadingTimers:function(e){e.readingTimers.forEach(clearInterval)},setMessageSocket:function(e,t){e.messageSocket=t}},actions:{loadLayerImage:function(e,t){var a=URL.createObjectURL(t),n=new Image;n.src=a,n.onload=function(){e.state.editedLayer.imgurl&&URL.revokeObjectURL(e.state.editedLayer.imgurl);var s={file:t,imgurl:a,width:n.width,height:n.height};e.commit("setEditedLayerImage",s)},n.onerror=function(e){return console.log(e)}},loadDataAfterLogin:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.dispatch("getCurrentUser",t);case 2:return e.commit("replaceMode","view"),e.dispatch("openMessageSocket"),a.next=6,e.dispatch("downloadLayers");case 6:return a.next=8,e.dispatch("downloadDiscoveryResults");case 8:case"end":return a.stop()}}),a)})))()},login:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,rn.login(t);case 2:case"end":return e.stop()}}),e)})))()},getCurrentUser:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,rn.getCurrentUser();case 2:a=t.sent,e.commit("setUser",a);case 4:case"end":return t.stop()}}),t)})))()},logout:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit("clearReadingTimers"),e.commit("setUser",null),e.dispatch("closeMessageSocket"),t.next=5,rn.logout();case 5:case"end":return t.stop()}}),t)})))()},changePassword:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,rn.changePassword(t);case 2:case"end":return e.stop()}}),e)})))()},downloadLayers:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,rn.getLayers();case 2:a=t.sent,e.commit("setLayers",a),e.commit("clearReadingTimers"),e.dispatch("setReadingTimers");case 6:case"end":return t.stop()}}),t)})))()},downloadDiscoveryResults:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,rn.getDiscoveryResults();case 2:a=t.sent,e.commit("setDiscoveryResults",a),e.commit("writeDiscoveryStatusToNodes");case 5:case"end":return t.stop()}}),t)})))()},saveEditedLayer:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.getters.activeLayer,!a.isNewImage){t.next=6;break}return t.next=4,rn.sendLayer(a,e.state.editedLayerImageFile);case 4:t.next=8;break;case 6:return t.next=8,rn.sendLayer(a);case 8:return t.next=10,e.dispatch("downloadLayers");case 10:case"end":return t.stop()}}),t)})))()},deleteLayer:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,rn.deleteLayer(t);case 2:return a.next=4,e.dispatch("downloadLayers");case 4:case"end":return a.stop()}}),a)})))()},sendMessage:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,rn.sendMessage(t);case 2:e.commit("addMessage",t);case 3:case"end":return a.stop()}}),a)})))()},addReceivedMessage:function(e,t){vn.commit("addMessage",t),vn.commit("updateLastReadings",t)},setReadingTimers:function(e){var t,a=Object(oa["a"])(e.state.layers);try{for(a.s();!(t=a.n()).done;){var n,s=t.value,r=Object(oa["a"])(s.nodes);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,d=Object(oa["a"])(i.readingConfigs);try{for(d.s();!(o=d.n()).done;){var c=o.value;if("send"===c.mode){var u={node:i,readingConfig:c},l=setInterval(e.dispatch,1e3*c.refreshPeriod,"sendMessageForReading",u);e.commit("addReadingTimer",l),e.dispatch("sendMessageForReading",u)}else if("at"===c.mode){var m={node:i,readingConfig:c},p=setInterval(e.dispatch,1e3*c.refreshPeriod,"sendAtCommandForReading",m);e.commit("addReadingTimer",p),e.dispatch("sendAtCommandForReading",m)}}}catch(f){d.e(f)}finally{d.f()}}}catch(f){r.e(f)}finally{r.f()}}}catch(f){a.e(f)}finally{a.f()}},sendMessageForReading:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={type:"sent",address64:t.node.address64,message:t.readingConfig.messageToSend},a.next=3,e.dispatch("sendMessage",n);case 3:case"end":return a.stop()}}),a)})))()},sendAtCommandForReading:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={commandType:"get_parameter",address64:t.node.address64,atCommand:t.readingConfig.atCommand,value:t.readingConfig.atCommandData},a.next=3,e.dispatch("sendAtCommand",n);case 3:s=a.sent,r="hex"===t.readingConfig.atCommandResultFormat?ht.decodeMessageToHex(s.result):"dec"===t.readingConfig.atCommandResultFormat?ht.decodeToDecBigEndian(s.result):ht.decodeMessageToText(s.result),e.commit("setLastReading",{readingConfig:t.readingConfig,lastReading:r});case 6:case"end":return a.stop()}}),a)})))()},sendAtCommand:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=Object(ra["a"])({type:"at",result:null},t),e.commit("addMessage",n),a.next=4,rn.sendAtCommand(t);case 4:return s=a.sent,n.result=s.result,a.abrupt("return",n);case 7:case"end":return a.stop()}}),a)})))()},openMessageSocket:function(e){var t=rn.makeMessageSocket();t.onmessage=function(e){return vn.dispatch("addReceivedMessage",JSON.parse(e.data))},e.commit("setMessageSocket",t)},closeMessageSocket:function(e){e.state.messageSocket&&e.state.messageSocket.close(1e3),e.commit("setMessageSocket",null)}},modules:{users:un}}),hn=vn;a("160f"),a("845f");n["a"].config.productionTip=!1,new n["a"]({store:hn,render:function(e){return e(sa)}}).$mount("#app")},5797:function(e,t,a){},5924:function(e,t,a){"use strict";a("1368")},5994:function(e,t,a){"use strict";a("ffdc")},"5e49":function(e,t,a){},"668f":function(e,t,a){"use strict";a("a887")},6951:function(e,t,a){"use strict";a("aab4")},"696f":function(e,t,a){},"6b39":function(e,t,a){e.exports=a.p+"img/marker-icon-gray.3d170c6f.png"},7387:function(e,t,a){e.exports=a.p+"img/x.df13156b.svg"},"80bf":function(e,t,a){},"845f":function(e,t,a){},"85bf":function(e,t,a){},"85ec":function(e,t,a){},8873:function(e,t,a){},"8b3c":function(e,t,a){},"8c48":function(e,t,a){"use strict";a("85bf")},"8ec0":function(e,t,a){e.exports=a.p+"img/marker-icon-purple.724a1ecc.png"},"94de":function(e,t,a){},9878:function(e,t,a){"use strict";a("2736")},"9a50":function(e,t,a){"use strict";a("94de")},"9bbf":function(e,t,a){"use strict";a("80bf")},a887:function(e,t,a){},a988:function(e,t,a){e.exports=a.p+"img/marker-icon-green.6f1bc0d9.png"},aab4:function(e,t,a){},adcf:function(e,t,a){"use strict";a("19cd")},b93f:function(e,t,a){},ba67:function(e,t,a){"use strict";a("50ef")},c0cf:function(e,t,a){"use strict";a("8873")},d104:function(e,t,a){e.exports=a.p+"img/person.d9dd9711.svg"},ec27:function(e,t,a){e.exports=a.p+"img/plan2.8f8fa675.png"},fd41:function(e,t,a){"use strict";a("5e49")},ffdc:function(e,t,a){}});
//# sourceMappingURL=app.be20f178.js.map